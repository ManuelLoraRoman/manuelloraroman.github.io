<!doctype html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-responsive-min.css">
  <link rel="stylesheet" href="/assets/styles.css">

   <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon.png">
   <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
   <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
   <link rel="manifest" href="/site.webmanifest">
   <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
   <meta name="msapplication-TileColor" content="#da532c">
   <meta name="theme-color" content="#ffffff"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Instalación y configuración inicial de los servidores | Programa</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Instalación y configuración inicial de los servidores" />
<meta name="author" content="Manuel Lora Román" />
<meta property="og:locale" content="en" />
<meta name="description" content="Creación y configuración de las máquinas Dulcinea, Quijote y Sancho." />
<meta property="og:description" content="Creación y configuración de las máquinas Dulcinea, Quijote y Sancho." />
<link rel="canonical" href="http://localhost:4000/2021/03/16/configuracion-maquinas/" />
<meta property="og:url" content="http://localhost:4000/2021/03/16/configuracion-maquinas/" />
<meta property="og:site_name" content="Programa" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-16T12:31:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Instalación y configuración inicial de los servidores" />
<meta name="twitter:site" content="@ManuelLoraRoman" />
<meta name="twitter:creator" content="@Manuel Lora Román" />
<meta name="google-site-verification" content="xxxxx" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/2021/03/16/configuracion-maquinas/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/logo.png"},"name":"Manuel Lora Román"},"headline":"Instalación y configuración inicial de los servidores","dateModified":"2021-03-16T12:32:25+01:00","datePublished":"2021-03-16T12:31:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/03/16/configuracion-maquinas/"},"description":"Creación y configuración de las máquinas Dulcinea, Quijote y Sancho.","author":{"@type":"Person","name":"Manuel Lora Román"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Programa" />
</head>


  <body>

    <div class="container pure-g"><div class="sidebar-left pure-u-1 pure-u-md-1-4" style="background-color: rgb(40, 73, 77); color: rgb(255, 255, 255); background-image: url(/bg.jpeg);"><header class="masthead">
  <div class="avatar"><img src="/avatar.jpeg" class="avatar-image" alt="Manuel Lora Román">
    </div>
  <div class="masthead-title">
    <a href="/" title="Home">Programa</a>
  </div>
  <div class="masthead-tagline">
    <small>Blog de pŕacticas y ejercicios</small>
  </div><nav class="navigation">
    <ul class="navigation-list"><li class="navigation-item">
        <a onclick="sessionStorage.setItem('forceCheckScroll', 'true')" href="/">Inicio</a>
      </li><li class="navigation-item">
        <a onclick="sessionStorage.setItem('forceCheckScroll', 'true')" href="/about/">Sobre mí</a>
      </li></ul>
  </nav><div class="social pure-menu pure-menu-horizontal">
      <ul class="social-icons pure-menu-list">
      <li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="mailto://manuelloraroman@gmail.com">
            <i class="fas fa-envelope" title="Email"></i>
          </a>
        </li><li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="https://twitter.com/ManuelLoraRoman">
            <i class="fab fa-twitter" title="Twitter"></i>
          </a>
        </li><li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="https://github.com/ManuelLoraRoman">
            <i class="fab fa-github" title="GitHub"></i>
          </a>
        </li><li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="https://www.facebook.com/manu.loraroman">
            <i class="fab fa-facebook" title="Facebook"></i>
          </a>
        </li><li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="https://www.linkedin.com/in/manuelloraroman/">
            <i class="fab fa-linkedin" title="LinkedIn"></i>
          </a>
        </li>
      </ul>
    </div>
</header>
</div>

      <div class="content pure-u-1 pure-u-md-1-2"><main>
  <article class="post">
  <h1 class="post-title">Instalación y configuración inicial de los servidores</h1>
  <div class="post-meta"><time datetime="2021-03-16T12:31:00+01:00" itemprop="datePublished">16 Mar 2021</time><span> ~ </span><time datetime="2021-03-16T12:32:25+01:00" itemprop="dateModified">
        16 Mar 2021
      </time></div>

  <p class="message">Creación y configuración de las máquinas Dulcinea, Quijote y Sancho.</p>

<h2 id="creación-de-la-red-interna">Creación de la red interna:</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.1. Nombre red interna de &lt;nombre de usuario&gt;
1.2. 10.0.1.0/24
</code></pre></div></div>

<p>En primer lugar nos iremos a Openstack, y en el apartado de <em>RED –&gt; Redes</em>
seleccionaremos la opción de <em>Crear red</em>.</p>

<p>Crearemos una red llamada <em>red de manuel-lora</em> con las siguientes opciones:</p>

<ul>
  <li>
    <p>Nombre: red de manuel-lora</p>
  </li>
  <li>
    <p>Estado de administración: ARRIBA</p>
  </li>
  <li>
    <p>Crear subred: TRUE</p>
  </li>
  <li>
    <p>Direcciones de red: 10.0.1.0/24</p>
  </li>
  <li>
    <p>Versión de IP: IPv4</p>
  </li>
</ul>

<p>Y ya tendriamos nuestra red operativa:</p>

<p><img src="/assets/img/redmanuellora.png" alt="image" /></p>

<h2 id="creación-de-las-instancias">Creación de las instancias</h2>

<p>Antes de la creación de ninguna máquina, vamos a crear 3 volúmenes de imagen
de Debian Buster 10.6, Ubuntu 20.04 LTS y CentOS 7, con una capacidad de 
4, 6 y 16 GiB respectivamente.</p>

<p>Estas operaciones las podemos realizar en la pestaña de Openstack <em>COMPUTE –&gt; Volúmenes –&gt; Crear Volumen</em></p>

<p><img src="/assets/img/volumenesstack.png" alt="image" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2.1. Dulcinea:
       2.1.1. Debian Buster sobre volumen con sabor m1.mini
       2.1.2. Accesible directamente a través de la red externa y con una 
	  IP flotante
       2.1.3. Conectada a la red interna, de la que será la puerta de enlace
</code></pre></div></div>

<p>Crearemos la máquina con las respectivas configuracion anteriormente comentadas,
y nos quedaría una máquina como esta:</p>

<p><img src="/assets/img/dulcinea1.png" alt="image" /></p>

<p>Y una comprobación de conectividad:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="code"><pre><span class="nx">manuel</span><span class="p">@</span><span class="nd">debian</span><span class="p">:</span><span class="o">~</span><span class="sr">/.ssh$ ssh -i clave_openstack.pem debian@172.22.200.14</span><span class="err">6
</span><span class="nx">The</span> <span class="nx">authenticity</span> <span class="k">of</span> <span class="nx">host</span> <span class="dl">'</span><span class="s1">172.22.200.146 (172.22.200.146)</span><span class="dl">'</span> <span class="nx">can</span><span class="dl">'</span><span class="s1">t be established.
ECDSA key fingerprint is SHA256:KyvO3NYfqO8qxyViGkVvjnNtS01PAd1WUN8xzo+Umxk.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added </span><span class="dl">'</span><span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span><span class="dl">'</span><span class="s1"> (ECDSA) to the list of known hosts.
Linux dulcinea 4.19.0-11-cloud-amd64 #1 SMP Debian 4.19.146-1 (2020-09-17) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
debian@dulcinea:~$ ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 8950 qdisc pfifo_fast state UP group default qlen 1000
    link/ether fa:16:3e:f3:34:21 brd ff:ff:ff:ff:ff:ff
    inet 10.0.1.4/24 brd 10.0.1.255 scope global dynamic eth0
       valid_lft 86256sec preferred_lft 86256sec
    inet6 fe80::f816:3eff:fef3:3421/64 scope link 
       valid_lft forever preferred_lft forever
3: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 8950 qdisc pfifo_fast state UP group default qlen 1000
    link/ether fa:16:3e:87:e0:77 brd ff:ff:ff:ff:ff:ff
    inet 10.0.0.9/24 brd 10.0.0.255 scope global dynamic eth1
       valid_lft 86256sec preferred_lft 86256sec
    inet6 fe80::f816:3eff:fe87:e077/64 scope link 
       valid_lft forever preferred_lft forever
debian@dulcinea:~$ </span>
</pre></td></tr></tbody></table></code></pre></figure>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2.2. Sancho:
        2.2.1. Ubuntu 20.04 sobre volumen con sabor m1.mini
        2.2.2. Conectada a la red interna
        2.2.3. Accesible indirectamente a través de dulcinea
</code></pre></div></div>

<p>Crearemos la siguiente máquina siguiendo las mismas directrices que los puntos
marcados.</p>

<p>Al final, la máquina Sancho debería quedar de la siguiente manera:</p>

<p><img src="/assets/img/sancho1.png" alt="image" /></p>

<p>Pasaremos el par de claves a la máquina de Dulcinea mediante scp para poder 
realizar la conectividad desde ahí.</p>

<p>Una vez hecho esto, vamos a comprobar la conectividad desde Dulcinea y desde
nuestra máquina:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ssh</span> <span class="o">-</span><span class="nx">i</span> <span class="p">.</span><span class="nx">ssh</span><span class="o">/</span><span class="nx">clave_openstack</span><span class="p">.</span><span class="nx">pem</span> <span class="nx">ubuntu</span><span class="p">@</span><span class="nd">10</span><span class="p">.</span><span class="mf">0.1</span><span class="p">.</span><span class="mi">11</span>
<span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">Ubuntu</span> <span class="mf">20.04</span><span class="p">.</span><span class="mi">1</span> <span class="nx">LTS</span> <span class="p">(</span><span class="nx">GNU</span><span class="o">/</span><span class="nx">Linux</span> <span class="mf">5.4</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nx">generic</span> <span class="nx">x86_64</span><span class="p">)</span>

 <span class="o">*</span> <span class="nx">Documentation</span><span class="p">:</span>  <span class="nx">https</span><span class="p">:</span><span class="c1">//help.ubuntu.com</span>
 <span class="o">*</span> <span class="nx">Management</span><span class="p">:</span>     <span class="nx">https</span><span class="p">:</span><span class="c1">//landscape.canonical.com</span>
 <span class="o">*</span> <span class="nx">Support</span><span class="p">:</span>        <span class="nx">https</span><span class="p">:</span><span class="c1">//ubuntu.com/advantage</span>

  <span class="nx">System</span> <span class="nx">information</span> <span class="k">as</span> <span class="k">of</span> <span class="nx">Sat</span> <span class="nx">Nov</span>  <span class="mi">7</span> <span class="mi">16</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span> <span class="nx">UTC</span> <span class="mi">2020</span>

  <span class="nx">System</span> <span class="nx">load</span><span class="p">:</span>  <span class="mf">0.17</span>              <span class="nx">Processes</span><span class="p">:</span>             <span class="mi">96</span>
  <span class="nx">Usage</span> <span class="k">of</span> <span class="sr">/:   21.8% of 5.64GB   Users logged in:       </span><span class="err">0
</span>  <span class="nx">Memory</span> <span class="nx">usage</span><span class="p">:</span> <span class="mi">38</span><span class="o">%</span>               <span class="nx">IPv4</span> <span class="nx">address</span> <span class="k">for</span> <span class="nx">ens3</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span>
  <span class="nx">Swap</span> <span class="nx">usage</span><span class="p">:</span>   <span class="mi">0</span><span class="o">%</span>


<span class="mi">1</span> <span class="nx">update</span> <span class="nx">can</span> <span class="nx">be</span> <span class="nx">installed</span> <span class="nx">immediately</span><span class="p">.</span>
<span class="mi">0</span> <span class="k">of</span> <span class="nx">these</span> <span class="nx">updates</span> <span class="nx">are</span> <span class="nx">security</span> <span class="nx">updates</span><span class="p">.</span>
<span class="nx">To</span> <span class="nx">see</span> <span class="nx">these</span> <span class="nx">additional</span> <span class="nx">updates</span> <span class="nx">run</span><span class="p">:</span> <span class="nx">apt</span> <span class="nx">list</span> <span class="o">--</span><span class="nx">upgradable</span>


<span class="nx">The</span> <span class="nx">list</span> <span class="k">of</span> <span class="nx">available</span> <span class="nx">updates</span> <span class="nx">is</span> <span class="nx">more</span> <span class="nx">than</span> <span class="nx">a</span> <span class="nx">week</span> <span class="nx">old</span><span class="p">.</span>
<span class="nx">To</span> <span class="nx">check</span> <span class="k">for</span> <span class="k">new</span> <span class="nx">updates</span> <span class="nx">run</span><span class="p">:</span> <span class="nx">sudo</span> <span class="nx">apt</span> <span class="nx">update</span>

<span class="nx">Last</span> <span class="nx">login</span><span class="p">:</span> <span class="nx">Sat</span> <span class="nx">Nov</span>  <span class="mi">7</span> <span class="mi">16</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">43</span> <span class="mi">2020</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span>
<span class="nx">To</span> <span class="nx">run</span> <span class="nx">a</span> <span class="nx">command</span> <span class="k">as</span> <span class="nx">administrator</span> <span class="p">(</span><span class="nx">user</span> <span class="dl">"</span><span class="s2">root</span><span class="dl">"</span><span class="p">),</span> <span class="nx">use</span> <span class="dl">"</span><span class="s2">sudo &lt;command&gt;</span><span class="dl">"</span><span class="p">.</span>
<span class="nx">See</span> <span class="dl">"</span><span class="s2">man sudo_root</span><span class="dl">"</span> <span class="k">for</span> <span class="nx">details</span><span class="p">.</span>

<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ip</span> <span class="nx">a</span>
<span class="mi">1</span><span class="p">:</span> <span class="nx">lo</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">LOOPBACK</span><span class="p">,</span><span class="nx">UP</span><span class="p">,</span><span class="nx">LOWER_UP</span><span class="o">&gt;</span> <span class="nx">mtu</span> <span class="mi">65536</span> <span class="nx">qdisc</span> <span class="nx">noqueue</span> <span class="nx">state</span> <span class="nx">UNKNOWN</span> <span class="nx">group</span> <span class="k">default</span> <span class="nx">qlen</span> <span class="mi">1000</span>
    <span class="nx">link</span><span class="o">/</span><span class="nx">loopback</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="nx">brd</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
    <span class="nx">inet</span> <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">8</span> <span class="nx">scope</span> <span class="nx">host</span> <span class="nx">lo</span>
       <span class="nx">valid_lft</span> <span class="nx">forever</span> <span class="nx">preferred_lft</span> <span class="nx">forever</span>
    <span class="nx">inet6</span> <span class="p">::</span><span class="mi">1</span><span class="o">/</span><span class="mi">128</span> <span class="nx">scope</span> <span class="nx">host</span> 
       <span class="nx">valid_lft</span> <span class="nx">forever</span> <span class="nx">preferred_lft</span> <span class="nx">forever</span>
<span class="mi">2</span><span class="p">:</span> <span class="nx">ens3</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">BROADCAST</span><span class="p">,</span><span class="nx">MULTICAST</span><span class="p">,</span><span class="nx">UP</span><span class="p">,</span><span class="nx">LOWER_UP</span><span class="o">&gt;</span> <span class="nx">mtu</span> <span class="mi">8950</span> <span class="nx">qdisc</span> <span class="nx">fq_codel</span> <span class="nx">state</span> <span class="nx">UP</span> <span class="nx">group</span> <span class="k">default</span> <span class="nx">qlen</span> <span class="mi">1000</span>
    <span class="nx">link</span><span class="o">/</span><span class="nx">ether</span> <span class="nx">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="nx">e</span><span class="p">:</span><span class="nx">da</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">73</span> <span class="nx">brd</span> <span class="nx">ff</span><span class="p">:</span><span class="nx">ff</span><span class="p">:</span><span class="nx">ff</span><span class="p">:</span><span class="nx">ff</span><span class="p">:</span><span class="nx">ff</span><span class="p">:</span><span class="nx">ff</span>
    <span class="nx">inet</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="o">/</span><span class="mi">24</span> <span class="nx">brd</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.255</span> <span class="nx">scope</span> <span class="nb">global</span> <span class="nx">dynamic</span> <span class="nx">ens3</span>
       <span class="nx">valid_lft</span> <span class="mi">85440</span><span class="nx">sec</span> <span class="nx">preferred_lft</span> <span class="mi">85440</span><span class="nx">sec</span>
    <span class="nx">inet6</span> <span class="nx">fe80</span><span class="p">::</span><span class="nx">f816</span><span class="p">:</span><span class="mi">3</span><span class="nx">eff</span><span class="p">:</span><span class="nx">feda</span><span class="p">:</span><span class="mi">5973</span><span class="o">/</span><span class="mi">64</span> <span class="nx">scope</span> <span class="nx">link</span> 
       <span class="nx">valid_lft</span> <span class="nx">forever</span> <span class="nx">preferred_lft</span> <span class="nx">forever</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    2.3. Quijote:
        2.3.1. CentOS 7 sobre volumen con sabor m1.mini
        2.3.2. Conectada a la red interna
        2.3.3. Accesible indirectamente a través de dulcinea
</code></pre></div></div>

<p>Haremos lo mismo que con las otras dos máquinas y tendría que quedarnos así:</p>

<p><img src="/assets/img/quijote1.png" alt="image" /></p>

<p>Y la comprobación de la conectividad:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ssh</span> <span class="o">-</span><span class="nx">i</span> <span class="p">.</span><span class="nx">ssh</span><span class="o">/</span><span class="nx">clave_openstack</span><span class="p">.</span><span class="nx">pem</span> <span class="nx">centos</span><span class="p">@</span><span class="nd">10</span><span class="p">.</span><span class="mf">0.1</span><span class="p">.</span><span class="mi">12</span>
<span class="nx">The</span> <span class="nx">authenticity</span> <span class="k">of</span> <span class="nx">host</span> <span class="dl">'</span><span class="s1">10.0.1.12 (10.0.1.12)</span><span class="dl">'</span> <span class="nx">can</span><span class="dl">'</span><span class="s1">t be established.
ECDSA key fingerprint is SHA256:zfaz5ovbe6LO0PqUB9Xa6mL/vurmZT6K61ym+WWcFXY.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added </span><span class="dl">'</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="dl">'</span><span class="s1"> (ECDSA) to the list of known hosts.
[centos@quijote ~]$ ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 8950 qdisc pfifo_fast state UP group default qlen 1000
    link/ether fa:16:3e:db:75:33 brd ff:ff:ff:ff:ff:ff
    inet 10.0.1.12/24 brd 10.0.1.255 scope global dynamic eth0
       valid_lft 86367sec preferred_lft 86367sec
    inet6 fe80::f816:3eff:fedb:7533/64 scope link 
       valid_lft forever preferred_lft forever
[centos@quijote ~]$ </span>
</pre></td></tr></tbody></table></code></pre></figure>

<h2 id="configuración-de-nat-en-dulcinea">Configuración de NAT en Dulcinea</h2>

<p>(Es necesario deshabilitar la seguridad en todos los puertos de dulcinea) [[https://youtu.be/jqfILWzHrS0]]</p>

<p>Iniciaremos openstack desde la terminal. Una vez lo tengamos configurado,
vamos a eliminar el grupo de seguridad configurado desde openstack de la
máquina Dulcinea de la siguiente manera:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="p">(</span><span class="nx">openstackclient</span><span class="p">)</span> <span class="nx">manuel</span><span class="p">@</span><span class="nd">debian</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">openstack</span> <span class="nx">server</span> <span class="nx">remove</span> <span class="nx">security</span> <span class="nx">group</span> <span class="nx">Dulcinea</span> <span class="k">default</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>De esta manera comprobaremos que no tenemos conectividad con Dulcinea:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="p">(</span><span class="nx">openstackclient</span><span class="p">)</span> <span class="nx">manuel</span><span class="p">@</span><span class="nd">debian</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span>
<span class="nx">PING</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span> <span class="p">(</span><span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">4</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">0</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">100</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">54</span><span class="nx">ms</span>

<span class="p">(</span><span class="nx">openstackclient</span><span class="p">)</span> <span class="nx">manuel</span><span class="p">@</span><span class="nd">debian</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ssh</span> <span class="o">-</span><span class="nx">i</span> <span class="p">.</span><span class="nx">ssh</span><span class="o">/</span><span class="nx">clave_openstack</span><span class="p">.</span><span class="nx">pem</span> <span class="nx">debian</span><span class="p">@</span><span class="nd">172</span><span class="p">.</span><span class="mf">22.200</span><span class="p">.</span><span class="mi">146</span>
<span class="o">^</span><span class="nx">C</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>A continuación, vamos a listar los puertos y elegiremos la dirección MAC 
correspondiente a la máquina Dulcinea, para después realizar:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="p">(</span><span class="nx">openstackclient</span><span class="p">)</span> <span class="nx">manuel</span><span class="p">@</span><span class="nd">debian</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">openstack</span> <span class="nx">port</span> <span class="kd">set</span> <span class="o">--</span><span class="nx">disable</span><span class="o">-</span><span class="nx">port</span><span class="o">-</span><span class="nx">security</span> <span class="mi">17</span><span class="nx">ad903c</span><span class="o">-</span><span class="mi">923</span><span class="nx">a</span><span class="o">-</span><span class="mi">4</span><span class="nx">dec</span><span class="o">-</span><span class="mi">88</span><span class="nx">e5</span><span class="o">-</span><span class="mi">285022</span><span class="nx">b42da1</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Como hemos deshabilitado la seguridad de los puertos, volvemos a tener
conectividad:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="p">(</span><span class="nx">openstackclient</span><span class="p">)</span> <span class="nx">manuel</span><span class="p">@</span><span class="nd">debian</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span>
<span class="nx">PING</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span> <span class="p">(</span><span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">61</span> <span class="nx">time</span><span class="o">=</span><span class="mi">230</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">61</span> <span class="nx">time</span><span class="o">=</span><span class="mi">254</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">61</span> <span class="nx">time</span><span class="o">=</span><span class="mi">111</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">4</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">61</span> <span class="nx">time</span><span class="o">=</span><span class="mi">199</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">172.22</span><span class="p">.</span><span class="mf">200.146</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">4</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">4</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">4</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">110.790</span><span class="o">/</span><span class="mf">198.613</span><span class="o">/</span><span class="mf">254.447</span><span class="o">/</span><span class="mf">54.348</span> <span class="nx">ms</span>
<span class="p">(</span><span class="nx">openstackclient</span><span class="p">)</span> <span class="nx">manuel</span><span class="p">@</span><span class="nd">debian</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ssh</span> <span class="o">-</span><span class="nx">i</span> <span class="p">.</span><span class="nx">ssh</span><span class="o">/</span><span class="nx">clave_openstack</span><span class="p">.</span><span class="nx">pem</span> <span class="nx">debian</span><span class="p">@</span><span class="nd">172</span><span class="p">.</span><span class="mf">22.200</span><span class="p">.</span><span class="mi">146</span>
<span class="nx">Linux</span> <span class="nx">dulcinea</span> <span class="mf">4.19</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="nx">cloud</span><span class="o">-</span><span class="nx">amd64</span> <span class="err">#</span><span class="mi">1</span> <span class="nx">SMP</span> <span class="nx">Debian</span> <span class="mf">4.19</span><span class="p">.</span><span class="mi">146</span><span class="o">-</span><span class="mi">1</span> <span class="p">(</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">17</span><span class="p">)</span> <span class="nx">x86_64</span>

<span class="nx">The</span> <span class="nx">programs</span> <span class="nx">included</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">Debian</span> <span class="nx">GNU</span><span class="o">/</span><span class="nx">Linux</span> <span class="nx">system</span> <span class="nx">are</span> <span class="nx">free</span> <span class="nx">software</span><span class="p">;</span>
<span class="nx">the</span> <span class="nx">exact</span> <span class="nx">distribution</span> <span class="nx">terms</span> <span class="k">for</span> <span class="nx">each</span> <span class="nx">program</span> <span class="nx">are</span> <span class="nx">described</span> <span class="k">in</span> <span class="nx">the</span>
<span class="nx">individual</span> <span class="nx">files</span> <span class="k">in</span> <span class="sr">/usr/</span><span class="nx">share</span><span class="o">/</span><span class="nx">doc</span><span class="cm">/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Nov 10 17:19:39 2020 from 172.23.0.78
debian@dulcinea:~$</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Realizada la deshabilitación de puertos, vamos a pasar a la configuración de NAT.
En Dulcinea, para que está pueda funcionar como dispositivo de NAT, hay que 
activar el bit de forward:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="nx">root</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">debian</span><span class="err">#</span> <span class="nx">echo</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="sr">/proc/</span><span class="nx">sys</span><span class="o">/</span><span class="nx">net</span><span class="o">/</span><span class="nx">ipv4</span><span class="o">/</span><span class="nx">ip_forward</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Esta configuración es volátil, por lo tanto, la definiremos en el fichero
<em>/etc/sysctl.conf</em>:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="err">#</span> <span class="nx">Uncomment</span> <span class="nx">the</span> <span class="nx">next</span> <span class="nx">line</span> <span class="nx">to</span> <span class="nx">enable</span> <span class="nx">packet</span> <span class="nx">forwarding</span> <span class="k">for</span> <span class="nx">IPv4</span>
<span class="nx">net</span><span class="p">.</span><span class="nx">ipv4</span><span class="p">.</span><span class="nx">ip_forward</span><span class="o">=</span><span class="mi">1</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Ahora definimos en la cadena POSTROUTING lo siguiente:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="nx">iptables</span> <span class="o">-</span><span class="nx">t</span> <span class="nx">nat</span> <span class="o">-</span><span class="nx">A</span> <span class="nx">POSTROUTING</span> <span class="o">-</span><span class="nx">s</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">24</span> <span class="o">-</span><span class="nx">o</span> <span class="nx">eth1</span> <span class="o">-</span><span class="nx">j</span> <span class="nx">MASQUERADE</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Cada vez que iniciamos el cliente Dulcinea, la información de las iptables se 
reiniciará, por lo tanto, la guardaremos con <em>iptables-save</em> y cuando 
volvamos a iniciar la máquina, restauraremos la configuración con 
<em>iptables-restore</em>.</p>

<p>Antes de reiniciar el servicio, modificaremos el fichero <em>/etc/network/interfaces</em>
para poner la ip estática de Dulcinea:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="code"><pre><span class="err">#</span> <span class="nx">This</span> <span class="nx">file</span> <span class="nx">describes</span> <span class="nx">the</span> <span class="nx">network</span> <span class="nx">interfaces</span> <span class="nx">available</span> <span class="nx">on</span> <span class="nx">your</span> <span class="nx">system</span>
<span class="err">#</span> <span class="nx">and</span> <span class="nx">how</span> <span class="nx">to</span> <span class="nx">activate</span> <span class="nx">them</span><span class="p">.</span> <span class="nx">For</span> <span class="nx">more</span> <span class="nx">information</span><span class="p">,</span> <span class="nx">see</span> <span class="nx">interfaces</span><span class="p">(</span><span class="mi">5</span><span class="p">).</span>

<span class="err">#</span> <span class="nx">The</span> <span class="nx">loopback</span> <span class="nx">network</span> <span class="kr">interface</span>
<span class="nx">auto</span> <span class="nx">lo</span>
<span class="nx">iface</span> <span class="nx">lo</span> <span class="nx">inet</span> <span class="nx">loopback</span>

<span class="err">#</span> <span class="nx">The</span> <span class="nx">normal</span> <span class="nx">eth0</span>
<span class="nx">allow</span><span class="o">-</span><span class="nx">hotplug</span> <span class="nx">eth0</span>
<span class="nx">iface</span> <span class="nx">eth0</span> <span class="nx">inet</span> <span class="nx">dhcp</span>
 <span class="nx">address</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span>
 <span class="nx">netmask</span> <span class="mf">255.255</span><span class="p">.</span><span class="mf">255.0</span>
 <span class="nx">broadcast</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.255</span>

<span class="err">#</span> <span class="nx">Additional</span> <span class="nx">interfaces</span><span class="p">,</span> <span class="nx">just</span> <span class="k">in</span> <span class="k">case</span> <span class="nx">we</span><span class="dl">'</span><span class="s1">re using
# multiple networks
allow-hotplug eth1
iface eth1 inet dhcp
 address 10.0.0.9
 netmask 255.255.255.0
 broadcast 10.0.0.255
 gateway 10.0.0.1

allow-hotplug eth2
iface eth2 inet dhcp

# Set this one last, so that cloud-init or user can
# override defaults.
source /etc/network/interfaces.d/*</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Reiniciamos el servicio de networking y comprobamos que efectivamente tenemos
conectividad:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.1</span>
<span class="nx">PING</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.1</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.537</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.805</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.807</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.1</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">28</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.537</span><span class="o">/</span><span class="mf">0.716</span><span class="o">/</span><span class="mf">0.807</span><span class="o">/</span><span class="mf">0.128</span> <span class="nx">ms</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.2</span>
<span class="nx">PING</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.2</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">0.2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">2.21</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.857</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.765</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">0.2</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">5</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.765</span><span class="o">/</span><span class="mf">1.276</span><span class="o">/</span><span class="mf">2.206</span><span class="o">/</span><span class="mf">0.658</span> <span class="nx">ms</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span>
<span class="nx">PING</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">2.33</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">1.16</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">2</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">2</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">3</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">1.159</span><span class="o">/</span><span class="mf">1.742</span><span class="o">/</span><span class="mf">2.325</span><span class="o">/</span><span class="mf">0.583</span> <span class="nx">ms</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span>
<span class="nx">PING</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.985</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.689</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">2</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">2</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">2</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.689</span><span class="o">/</span><span class="mf">0.837</span><span class="o">/</span><span class="mf">0.985</span><span class="o">/</span><span class="mf">0.148</span> <span class="nx">ms</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Ahora, nos introduciremos en la máquina Ubuntu (Sancho) y modificaremos el 
fichero <em>/etc/netplan/50-cloud-init.yaml</em> con la siguiente información:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="err">#</span> <span class="nx">This</span> <span class="nx">file</span> <span class="nx">is</span> <span class="nx">generated</span> <span class="k">from</span> <span class="nx">information</span> <span class="nx">provided</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">datasource</span><span class="p">.</span>  <span class="nx">Changes</span>
<span class="err">#</span> <span class="nx">to</span> <span class="nx">it</span> <span class="nx">will</span> <span class="nx">not</span> <span class="nx">persist</span> <span class="nx">across</span> <span class="nx">an</span> <span class="nx">instance</span> <span class="nx">reboot</span><span class="p">.</span>  <span class="nx">To</span> <span class="nx">disable</span> <span class="nx">cloud</span><span class="o">-</span><span class="nx">init</span><span class="dl">'</span><span class="s1">s
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disable}

network:
  version: 2
  renderer: networkd
  ethernets:
    ens3:
      dhcp4: no
      addresses:
        - 10.0.1.11/24
      gateway4: 10.0.1.4
      nameservers:
          addresses: [192.168.202.2, 8.8.8.8, 8.8.4.4]</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Reiniciamos el servicio y comprobamos que tenemos conectividad:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="code"><pre><span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="nx">www</span><span class="p">.</span><span class="nx">google</span><span class="p">.</span><span class="nx">es</span>
<span class="nx">PING</span> <span class="nx">www</span><span class="p">.</span><span class="nx">google</span><span class="p">.</span><span class="nx">es</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">arn02s06</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="nx">f163</span><span class="p">.</span><span class="mi">1</span><span class="nx">e100</span><span class="p">.</span><span class="nx">net</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">112</span> <span class="nx">time</span><span class="o">=</span><span class="mi">251</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">arn02s06</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="nx">f163</span><span class="p">.</span><span class="mi">1</span><span class="nx">e100</span><span class="p">.</span><span class="nx">net</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">112</span> <span class="nx">time</span><span class="o">=</span><span class="mi">275</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">arn02s06</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="nx">f163</span><span class="p">.</span><span class="mi">1</span><span class="nx">e100</span><span class="p">.</span><span class="nx">net</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">112</span> <span class="nx">time</span><span class="o">=</span><span class="mi">269</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="nx">www</span><span class="p">.</span><span class="nx">google</span><span class="p">.</span><span class="nx">es</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">2003</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">251.187</span><span class="o">/</span><span class="mf">265.202</span><span class="o">/</span><span class="mf">275.299</span><span class="o">/</span><span class="mf">10.226</span> <span class="nx">ms</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span>
<span class="nx">PING</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.949</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">1.26</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.872</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">2003</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.872</span><span class="o">/</span><span class="mf">1.026</span><span class="o">/</span><span class="mf">1.258</span><span class="o">/</span><span class="mf">0.166</span> <span class="nx">ms</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span>
<span class="nx">PING</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">3.98</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">1.12</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">1.04</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">2003</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">1.041</span><span class="o">/</span><span class="mf">2.047</span><span class="o">/</span><span class="mf">3.978</span><span class="o">/</span><span class="mf">1.365</span> <span class="nx">ms</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<p>Ahora pasándonos a CentOs (Quijote), para poner la IP estática, modificaremos el
fichero _/etc/sysconfig/network-scripts/ifcfg-eth0:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="code"><pre><span class="err">#</span> <span class="nx">Created</span> <span class="nx">by</span> <span class="nx">cloud</span><span class="o">-</span><span class="nx">init</span> <span class="nx">on</span> <span class="nx">instance</span> <span class="nx">boot</span> <span class="nx">automatically</span><span class="p">,</span> <span class="k">do</span> <span class="nx">not</span> <span class="nx">edit</span><span class="p">.</span>
<span class="err">#</span>
<span class="nx">DEVICE</span><span class="o">=</span><span class="dl">"</span><span class="s2">eth0</span><span class="dl">"</span>
<span class="nx">BOOTPROTO</span><span class="o">=</span><span class="dl">"</span><span class="s2">static</span><span class="dl">"</span>
<span class="nx">IPADDR</span><span class="o">=</span><span class="dl">"</span><span class="s2">10.0.1.12</span><span class="dl">"</span>
<span class="nx">NETMASK</span><span class="o">=</span><span class="dl">"</span><span class="s2">255.255.255.0</span><span class="dl">"</span>
<span class="nx">NETWORK</span><span class="o">=</span><span class="dl">"</span><span class="s2">10.0.1.0</span><span class="dl">"</span>
<span class="nx">GATEWAY</span><span class="o">=</span><span class="dl">"</span><span class="s2">10.0.1.4</span><span class="dl">"</span>
<span class="nx">ONBOOT</span><span class="o">=</span><span class="dl">"</span><span class="s2">yes</span><span class="dl">"</span>
<span class="nx">TYPE</span><span class="o">=</span><span class="dl">"</span><span class="s2">Ethernet</span><span class="dl">"</span>
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="o">~</span>                                                                               
<span class="dl">"</span><span class="s2">/etc/sysconfig/network-scripts/ifcfg-eth0</span><span class="dl">"</span> <span class="mi">10</span><span class="nx">L</span><span class="p">,</span> <span class="mi">214</span><span class="nx">C</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Y también, tenemos que modificar el fichero <em>/etc/resolv.config</em> si queremos
que nos resuelve el DNS.</p>

<p>Y comprobamos su funcionamiento:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="code"><pre><span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">ping</span> <span class="nx">www</span><span class="p">.</span><span class="nx">google</span><span class="p">.</span><span class="nx">es</span>
<span class="nx">PING</span> <span class="nx">www</span><span class="p">.</span><span class="nx">google</span><span class="p">.</span><span class="nx">es</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">arn02s06</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="nx">f163</span><span class="p">.</span><span class="mi">1</span><span class="nx">e100</span><span class="p">.</span><span class="nx">net</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">112</span> <span class="nx">time</span><span class="o">=</span><span class="mi">826</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">arn02s06</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="nx">f163</span><span class="p">.</span><span class="mi">1</span><span class="nx">e100</span><span class="p">.</span><span class="nx">net</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">112</span> <span class="nx">time</span><span class="o">=</span><span class="mi">929</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">arn02s06</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="nx">f163</span><span class="p">.</span><span class="mi">1</span><span class="nx">e100</span><span class="p">.</span><span class="nx">net</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">4</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">112</span> <span class="nx">time</span><span class="o">=</span><span class="mi">433</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">arn02s06</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="nx">f163</span><span class="p">.</span><span class="mi">1</span><span class="nx">e100</span><span class="p">.</span><span class="nx">net</span> <span class="p">(</span><span class="mf">216.58</span><span class="p">.</span><span class="mf">201.163</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">5</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">112</span> <span class="nx">time</span><span class="o">=</span><span class="mf">43.3</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="nx">www</span><span class="p">.</span><span class="nx">google</span><span class="p">.</span><span class="nx">es</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">5</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">4</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">20</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">4000</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">43.346</span><span class="o">/</span><span class="mf">558.257</span><span class="o">/</span><span class="mf">929.146</span><span class="o">/</span><span class="mf">350.137</span> <span class="nx">ms</span>
<span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span>
<span class="nx">PING</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.464</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.790</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.705</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">2000</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.464</span><span class="o">/</span><span class="mf">0.653</span><span class="o">/</span><span class="mf">0.790</span><span class="o">/</span><span class="mf">0.138</span> <span class="nx">ms</span>
<span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">ping</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span>
<span class="nx">PING</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">2.42</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">:</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">1.28</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">2</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">2</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">1001</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">1.282</span><span class="o">/</span><span class="mf">1.851</span><span class="o">/</span><span class="mf">2.420</span><span class="o">/</span><span class="mf">0.569</span> <span class="nx">ms</span>
<span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<h2 id="definición-de-contraseña-en-todas-las-instancias">Definición de contraseña en todas las instancias</h2>

<p>(Para poder modificarla desde consola en caso necesario)</p>

<p>Para configurar las contraseñas de las máquinas es necesario ejecutar el 
comando <em>sudo passwd</em>. Aquí las comprobaciones:</p>

<ul>
  <li>Dulcinea</li>
</ul>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">passwd</span>
<span class="nx">New</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">Retype</span> <span class="k">new</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">passwd</span><span class="p">:</span> <span class="nx">password</span> <span class="nx">updated</span> <span class="nx">successfully</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>Sancho</li>
</ul>

<p>Editaremos el fichero /etc/ssh/sshd_config y cambiamos las lineas:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="err">#</span><span class="nx">PermitRootLogin</span> <span class="nx">yes</span>
<span class="err">#</span><span class="nx">PasswordAuthentication</span> <span class="nx">yes</span>
</pre></td></tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">passwd</span>
<span class="nx">New</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">Retype</span> <span class="k">new</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">passwd</span><span class="p">:</span> <span class="nx">password</span> <span class="nx">updated</span> <span class="nx">successfully</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>Quijote</li>
</ul>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">passwd</span>
<span class="nx">Changing</span> <span class="nx">password</span> <span class="k">for</span> <span class="nx">user</span> <span class="nx">root</span><span class="p">.</span>
<span class="nx">New</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">BAD</span> <span class="nx">PASSWORD</span><span class="p">:</span> <span class="nx">The</span> <span class="nx">password</span> <span class="nx">is</span> <span class="nx">shorter</span> <span class="nx">than</span> <span class="mi">8</span> <span class="nx">characters</span>
<span class="nx">Retype</span> <span class="k">new</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">passwd</span><span class="p">:</span> <span class="nx">all</span> <span class="nx">authentication</span> <span class="nx">tokens</span> <span class="nx">updated</span> <span class="nx">successfully</span><span class="p">.</span>
<span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span>
</pre></td></tr></tbody></table></code></pre></figure>

<h2 id="modificación-de-las-instancias-sancho-y-quijote-para-que-usen-direccionamiento-estático-y-dulcinea-como-puerta-de-enlace">Modificación de las instancias sancho y quijote para que usen direccionamiento estático y dulcinea como puerta de enlace</h2>

<p>Realizado en el ejercicio de NAT.</p>

<h2 id="modificación-de-la-subred-de-la-red-interna-deshabilitando-el-servidor-dhcp">Modificación de la subred de la red interna, deshabilitando el servidor DHCP</h2>

<p>Nos meteremos en Openstack y en la sección de <em>RED –&gt; Redes</em> y nos metemos
en la Subred de la dirección 10.0.1.0, editamos la subred, y en detalles de la
subred, deseleccionamos la habilitación de DHCP.</p>

<h2 id="utilización-de-ssh-agent-para-acceder-a-las-instancias">Utilización de ssh-agent para acceder a las instancias</h2>

<p>Antes de nada, ejecutamos el comando <em>eval <code class="language-plaintext highlighter-rouge">ssh-agent</code></em> para que empiece
funcionando la herramienta del agente de ssh.</p>

<p>Después, tenemos que verificar el valor de la variable de entorno
SSH_AUTH_SOCK. Si está configurada, el agente se estaría ejecutando.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="sr">/.ssh$ echo $SSH_AUTH_SOC</span><span class="err">K
</span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">ssh</span><span class="o">-</span><span class="mi">8</span><span class="nx">YFDfSjY6loN</span><span class="o">/</span><span class="nx">agent</span><span class="p">.</span><span class="mi">1800</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>De forma predeterminada, el agente utiliza las claves almacenadas en el 
directorio <em>.ssh</em>. Usaremos <em>ssh-add</em> para agregar identidades al
agente.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="sr">/.ssh$ ssh-add clave_openstack.pem</span><span class="err"> 
</span><span class="nx">Identity</span> <span class="nx">added</span><span class="p">:</span> <span class="nx">clave_openstack</span><span class="p">.</span><span class="nx">pem</span> <span class="p">(</span><span class="nx">clave_openstack</span><span class="p">.</span><span class="nx">pem</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Podemos listar las claves privadas actualmente accesibles para el agente:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="sr">/.ssh$ ssh-add -</span><span class="err">l
</span><span class="mi">2048</span> <span class="nx">SHA256</span><span class="p">:</span><span class="nx">v4a</span><span class="o">+</span><span class="nx">YdJCSD5ggAQqJasflkDIKQiK1usKYPnLojG8m</span><span class="o">/</span><span class="nx">c</span> <span class="nx">clave_openstack</span><span class="p">.</span><span class="nx">pem</span> <span class="p">(</span><span class="nx">RSA</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>EL reenvio de agentes es un mecanismo mediante el cual un cliente permite 
al servidor ssh que use el agente ssh local ahi, como si fuese local. Para
utilizar este reenvío de agentes, tenemos que modificar el fichero de 
configuración <em>/etc/ssh/ssh_config</em> y /etc/ssh/sshd_config:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="err">#</span><span class="nx">AllowAgentForwarding</span> <span class="nx">yes</span>
<span class="err">#</span><span class="nx">ForwardAgent</span> <span class="nx">yes</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>El parámetro <em>AllowAgentForwarding</em> se establecerá en el servidor y el otro
en el cliente.</p>

<p>Comprobación:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ssh</span> <span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span>
<span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">Ubuntu</span> <span class="mf">20.04</span><span class="p">.</span><span class="mi">1</span> <span class="nx">LTS</span> <span class="p">(</span><span class="nx">GNU</span><span class="o">/</span><span class="nx">Linux</span> <span class="mf">5.4</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nx">generic</span> <span class="nx">x86_64</span><span class="p">)</span>

 <span class="o">*</span> <span class="nx">Documentation</span><span class="p">:</span>  <span class="nx">https</span><span class="p">:</span><span class="c1">//help.ubuntu.com</span>
 <span class="o">*</span> <span class="nx">Management</span><span class="p">:</span>     <span class="nx">https</span><span class="p">:</span><span class="c1">//landscape.canonical.com</span>
 <span class="o">*</span> <span class="nx">Support</span><span class="p">:</span>        <span class="nx">https</span><span class="p">:</span><span class="c1">//ubuntu.com/advantage</span>

  <span class="nx">System</span> <span class="nx">information</span> <span class="k">as</span> <span class="k">of</span> <span class="nx">Sat</span> <span class="nx">Nov</span> <span class="mi">14</span> <span class="mi">19</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">26</span> <span class="nx">UTC</span> <span class="mi">2020</span>

  <span class="nx">System</span> <span class="nx">load</span><span class="p">:</span>  <span class="mf">0.0</span>               <span class="nx">Processes</span><span class="p">:</span>             <span class="mi">100</span>
  <span class="nx">Usage</span> <span class="k">of</span> <span class="sr">/:   27.4% of 5.64GB   Users logged in:       </span><span class="err">0
</span>  <span class="nx">Memory</span> <span class="nx">usage</span><span class="p">:</span> <span class="mi">38</span><span class="o">%</span>               <span class="nx">IPv4</span> <span class="nx">address</span> <span class="k">for</span> <span class="nx">ens3</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span>
  <span class="nx">Swap</span> <span class="nx">usage</span><span class="p">:</span>   <span class="mi">0</span><span class="o">%</span>


<span class="mi">62</span> <span class="nx">updates</span> <span class="nx">can</span> <span class="nx">be</span> <span class="nx">installed</span> <span class="nx">immediately</span><span class="p">.</span>
<span class="mi">26</span> <span class="k">of</span> <span class="nx">these</span> <span class="nx">updates</span> <span class="nx">are</span> <span class="nx">security</span> <span class="nx">updates</span><span class="p">.</span>
<span class="nx">To</span> <span class="nx">see</span> <span class="nx">these</span> <span class="nx">additional</span> <span class="nx">updates</span> <span class="nx">run</span><span class="p">:</span> <span class="nx">apt</span> <span class="nx">list</span> <span class="o">--</span><span class="nx">upgradable</span>


<span class="nx">Last</span> <span class="nx">login</span><span class="p">:</span> <span class="nx">Sat</span> <span class="nx">Nov</span> <span class="mi">14</span> <span class="mi">19</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">30</span> <span class="mi">2020</span> <span class="k">from</span> <span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ssh</span> <span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span>
<span class="nx">Last</span> <span class="nx">login</span><span class="p">:</span> <span class="nx">Sat</span> <span class="nx">Nov</span> <span class="mi">14</span> <span class="mi">19</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">12</span> <span class="mi">2020</span> <span class="k">from</span> <span class="nx">gateway</span>
<span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<h2 id="creación-del-usuario-profesor-en-todas-las-instancias-usuario-que-puede-utilizar-sudo-sin-contraseña">Creación del usuario profesor en todas las instancias. Usuario que puede utilizar sudo sin contraseña</h2>

<p>Para crear un usuario, nos meteremos como root, y ejecutamos el comando:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">adduser</span> <span class="nx">profesor</span>
<span class="nx">Adding</span> <span class="nx">user</span> <span class="s2">`profesor' ...
Adding new group `</span><span class="nx">profesor</span><span class="dl">'</span><span class="s1"> (1001) ...
Adding new user `profesor</span><span class="dl">'</span> <span class="p">(</span><span class="mi">1001</span><span class="p">)</span> <span class="kd">with</span> <span class="nx">group</span> <span class="s2">`profesor' ...
Creating home directory `</span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">profesor</span><span class="dl">'</span><span class="s1"> ...
Copying files from `/etc/skel</span><span class="dl">'</span> <span class="p">...</span>
<span class="nx">New</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">Retype</span> <span class="k">new</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">passwd</span><span class="p">:</span> <span class="nx">password</span> <span class="nx">updated</span> <span class="nx">successfully</span>
<span class="nx">Changing</span> <span class="nx">the</span> <span class="nx">user</span> <span class="nx">information</span> <span class="k">for</span> <span class="nx">profesor</span>
<span class="nx">Enter</span> <span class="nx">the</span> <span class="k">new</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">or</span> <span class="nx">press</span> <span class="nx">ENTER</span> <span class="k">for</span> <span class="nx">the</span> <span class="k">default</span>
	<span class="nx">Full</span> <span class="nx">Name</span> <span class="p">[]:</span> <span class="nx">Profesor</span>
	<span class="nx">Room</span> <span class="nb">Number</span> <span class="p">[]:</span> 
	<span class="nx">Work</span> <span class="nx">Phone</span> <span class="p">[]:</span> 
	<span class="nx">Home</span> <span class="nx">Phone</span> <span class="p">[]:</span> 
	<span class="nx">Other</span> <span class="p">[]:</span> 
<span class="nx">Is</span> <span class="nx">the</span> <span class="nx">information</span> <span class="nx">correct</span><span class="p">?</span> <span class="p">[</span><span class="nx">Y</span><span class="o">/</span><span class="nx">n</span><span class="p">]</span> <span class="nx">Y</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Nos pedirá que le agreguemos una contraseña (en nuestro caso “profesor”) y una
vez terminado, añadiremos dicho usuario al fichero <em>/etc/sudoers</em> con la
siguiente linea:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="err">#</span> <span class="nx">User</span> <span class="nx">privilege</span> <span class="nx">specification</span>
<span class="nx">root</span>    <span class="nx">ALL</span><span class="o">=</span><span class="p">(</span><span class="nx">ALL</span><span class="p">:</span><span class="nx">ALL</span><span class="p">)</span> <span class="nx">ALL</span>
<span class="nx">profesor</span> <span class="nx">ALL</span><span class="o">=</span><span class="p">(</span><span class="nx">ALL</span><span class="p">:</span><span class="nx">ALL</span><span class="p">)</span> <span class="nx">NOPASSWD</span><span class="p">:</span><span class="nx">ALL</span>
<span class="err">#</span> <span class="nx">Allow</span> <span class="nx">members</span> <span class="k">of</span> <span class="nx">group</span> <span class="nx">sudo</span> <span class="nx">to</span> <span class="nx">execute</span> <span class="nx">any</span> <span class="nx">command</span>
<span class="o">%</span><span class="nx">sudo</span>   <span class="nx">ALL</span><span class="o">=</span><span class="p">(</span><span class="nx">ALL</span><span class="p">:</span><span class="nx">ALL</span><span class="p">)</span> <span class="nx">ALL</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>En Ubuntu los pasos a seguir son los mismos.
En CentOs cambia la cosa un poco. En primer lugar, ejecutaremos el siguiente
comando:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="p">[</span><span class="nx">root</span><span class="p">@</span><span class="nd">quijote</span> <span class="nx">centos</span><span class="p">]</span><span class="err">#</span> <span class="nx">adduser</span> <span class="nx">profesor</span>
<span class="p">[</span><span class="nx">root</span><span class="p">@</span><span class="nd">quijote</span> <span class="nx">centos</span><span class="p">]</span><span class="err">#</span> <span class="nx">passwd</span> <span class="nx">profesor</span>
<span class="nx">Changing</span> <span class="nx">password</span> <span class="k">for</span> <span class="nx">user</span> <span class="nx">profesor</span><span class="p">.</span>
<span class="nx">New</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">BAD</span> <span class="nx">PASSWORD</span><span class="p">:</span> <span class="nx">The</span> <span class="nx">password</span> <span class="nx">contains</span> <span class="nx">the</span> <span class="nx">user</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">some</span> <span class="nx">form</span>
<span class="nx">Retype</span> <span class="k">new</span> <span class="nx">password</span><span class="p">:</span> 
<span class="nx">passwd</span><span class="p">:</span> <span class="nx">all</span> <span class="nx">authentication</span> <span class="nx">tokens</span> <span class="nx">updated</span> <span class="nx">successfully</span><span class="p">.</span>
<span class="p">[</span><span class="nx">root</span><span class="p">@</span><span class="nd">quijote</span> <span class="nx">centos</span><span class="p">]</span><span class="err">#</span> <span class="p">[</span><span class="nx">root</span><span class="p">@</span><span class="nd">quijote</span> <span class="nx">centos</span><span class="p">]</span><span class="err">#</span> <span class="nx">usermod</span> <span class="o">-</span><span class="nx">aG</span> <span class="nx">wheel</span> <span class="nx">profesor</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Así creamos el usuario, con contraseña y lo añadimos al grupo que puede utilizar
el comando sudo.</p>

<p>Para que pueda acceder sin contraseña ejecutaremos el comando <em>sudo visudo</em>
y incorporaremos la siguiente linea:</p>

<blockquote>
  <p>profesor ALL=(ALL) NOPASSWD:ALL</p>
</blockquote>

<p>Y ya podriamos acceder sin contraseña a root en todas las máquinas desde el
usuario profesor.</p>

<h2 id="copia-de-las-claves-públicas-de-todos-los-profesores-en-las-instancias-para-que-puedan-acceder-con-el-usuario-profesor">Copia de las claves públicas de todos los profesores en las instancias para que puedan acceder con el usuario profesor</h2>

<p>Enviaremos mediante scp las claves de los profesores descargadas desde la wiki 
de Redmine a las máquinas.</p>

<p>Una vez en la máquina, la añadiremos con el siguiente comando al fichero
<em>authorized_keys</em>:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">echo</span> <span class="s2">`cat .ssh/clave-openstack.pub`</span> <span class="o">&gt;&gt;</span> <span class="p">.</span><span class="nx">ssh</span><span class="o">/</span><span class="nx">authorized_keys</span> 
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">echo</span> <span class="s2">`cat .ssh/rafa.pub`</span> <span class="o">&gt;&gt;</span> <span class="p">.</span><span class="nx">ssh</span><span class="o">/</span><span class="nx">authorized_keys</span> 
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">echo</span> <span class="s2">`cat .ssh/id_rsa.pub`</span> <span class="o">&gt;&gt;</span> <span class="p">.</span><span class="nx">ssh</span><span class="o">/</span><span class="nx">authorized_keys</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Y ya podrían acceder a la máquina con dichas claves.
El procedimiento es el mismo para todas las máquinas.</p>

<h2 id="realiza-una-actualización-completa-de-todos-los-servidores">Realiza una actualización completa de todos los servidores</h2>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="kd">get</span> <span class="nx">update</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">1</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.debian.org/debian-security buster/updates InRelease [65.4 kB]</span>
<span class="nx">Hit</span><span class="p">:</span><span class="mi">2</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster InRelease  </span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">3</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster-updates InRelease [51.9 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">4</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.debian.org/debian-security buster/updates/main Sources [154 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">5</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster-updates/main Sources.diff/Index [4,180 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">6</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster-updates/main amd64 Packages.diff/Index [4,180 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">7</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.debian.org/debian-security buster/updates/main amd64 Packages [248 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">8</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster-updates/main Sources 2020-10-24-2001.35.pdiff [414 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">8</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster-updates/main Sources 2020-10-24-2001.35.pdiff [414 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">9</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.debian.org/debian-security buster/updates/main Translation-en [135 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">10</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster-updates/main amd64 Packages 2020-10-24-2001.35.pdiff [286 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">10</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster-updates/main amd64 Packages 2020-10-24-2001.35.pdiff [286 B]</span>
<span class="nx">Fetched</span> <span class="mi">664</span> <span class="nx">kB</span> <span class="k">in</span> <span class="mi">2</span><span class="nx">s</span> <span class="p">(</span><span class="mi">270</span> <span class="nx">kB</span><span class="o">/</span><span class="nx">s</span><span class="p">)</span>
<span class="nx">Reading</span> <span class="kr">package</span> <span class="nx">lists</span><span class="p">...</span> <span class="nx">Done</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="code"><pre><span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="kd">get</span> <span class="nx">update</span>
<span class="nx">Hit</span><span class="p">:</span><span class="mi">1</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal InRelease                   </span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">2</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security InRelease [107 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">3</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates InRelease [111 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">4</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-backports InRelease [98.3 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">5</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/main amd64 Packages [368 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">6</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal/universe amd64 Packages [8628 kB] </span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">7</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/main Translation-en [84.1 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">8</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/main amd64 c-n-f Metadata [5396 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">9</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/restricted amd64 Packages [69.9 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">10</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/restricted Translation-en [11.4 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">11</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/universe amd64 Packages [517 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">12</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal/universe Translation-en [5124 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">13</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/universe Translation-en [66.9 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">14</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal/universe amd64 c-n-f Metadata [265 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">15</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/universe amd64 c-n-f Metadata [9220 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">16</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal/multiverse amd64 Packages [144 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">17</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal/multiverse Translation-en [104 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">18</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/multiverse amd64 Packages [1256 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">19</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal/multiverse amd64 c-n-f Metadata [9136 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">20</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/multiverse Translation-en [540 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">21</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//security.ubuntu.com/ubuntu focal-security/multiverse amd64 c-n-f Metadata [116 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">22</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages [655 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">23</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/main Translation-en [164 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">24</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/main amd64 c-n-f Metadata [11.0 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">25</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/restricted amd64 Packages [86.3 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">26</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/restricted Translation-en [13.5 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">27</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/universe amd64 Packages [689 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">28</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/universe Translation-en [133 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">29</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/universe amd64 c-n-f Metadata [13.0 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">30</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/multiverse amd64 Packages [15.6 kB]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">31</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/multiverse Translation-en [4352 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">32</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-updates/multiverse amd64 c-n-f Metadata [508 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">33</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-backports/main amd64 c-n-f Metadata [112 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">34</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-backports/restricted amd64 c-n-f Metadata [116 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">35</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-backports/universe amd64 Packages [4012 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">36</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-backports/universe Translation-en [1448 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">37</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-backports/universe amd64 c-n-f Metadata [224 B]</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">38</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//archive.ubuntu.com/ubuntu focal-backports/multiverse amd64 c-n-f Metadata [116 B]</span>
<span class="nx">Fetched</span> <span class="mf">17.5</span> <span class="nx">MB</span> <span class="k">in</span> <span class="mi">10</span><span class="nx">s</span> <span class="p">(</span><span class="mi">1709</span> <span class="nx">kB</span><span class="o">/</span><span class="nx">s</span><span class="p">)</span>                                             
<span class="nx">Reading</span> <span class="kr">package</span> <span class="nx">lists</span><span class="p">...</span> <span class="nx">Done</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">yum</span> <span class="nx">update</span>
<span class="nx">Loaded</span> <span class="nx">plugins</span><span class="p">:</span> <span class="nx">fastestmirror</span>
<span class="nx">Loading</span> <span class="nx">mirror</span> <span class="nx">speeds</span> <span class="k">from</span> <span class="nx">cached</span> <span class="nx">hostfile</span>
 <span class="o">*</span> <span class="nx">base</span><span class="p">:</span> <span class="nx">ftp</span><span class="p">.</span><span class="nx">cica</span><span class="p">.</span><span class="nx">es</span>
 <span class="o">*</span> <span class="nx">extras</span><span class="p">:</span> <span class="nx">ftp</span><span class="p">.</span><span class="nx">cica</span><span class="p">.</span><span class="nx">es</span>
 <span class="o">*</span> <span class="nx">updates</span><span class="p">:</span> <span class="nx">ftp</span><span class="p">.</span><span class="nx">cica</span><span class="p">.</span><span class="nx">es</span>
<span class="nx">No</span> <span class="nx">packages</span> <span class="nx">marked</span> <span class="k">for</span> <span class="nx">update</span>
<span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<h2 id="configura-el-servidor-con-el-nombre-de-dominio-gonzalonazarenoorg">Configura el servidor con el nombre de dominio <nombre-usuario>.gonzalonazareno.org</nombre-usuario></h2>

<p>Configuraremos el fichero <em>/etc/hostname</em> con el nombre de:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="nx">manuel</span><span class="o">-</span><span class="nx">lora</span><span class="p">.</span><span class="nx">gonzalonazareno</span><span class="p">.</span><span class="nx">org</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Y después configuraremos el fichero <em>/etc/hosts</em> y cambiaremos la de la 
dirección 127…… con manuel-lora.gonzalonazareno.org.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="mf">127.0</span><span class="p">.</span><span class="mf">1.1</span> <span class="nx">manuel</span><span class="o">-</span><span class="nx">lora</span><span class="p">.</span><span class="nx">gonzalonazareno</span><span class="p">.</span><span class="nx">org</span> <span class="nx">dulcinea</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span> <span class="nx">localhost</span>
</pre></td></tr></tbody></table></code></pre></figure>

<h2 id="hasta-que-no-esté-configurado-el-servidor-dns-incluye-resolución-estática-en-las-tres-instancias">Hasta que no esté configurado el servidor DNS, incluye resolución estática en las tres instancias</h2>

<p>tanto usando nombre completo como hostname.</p>

<p>Modicamos el fichero /etc/hosts y editamos las siguientes lineas:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span> <span class="nx">quijote</span>
<span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span> <span class="nx">sancho</span>
</pre></td></tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="nx">sancho</span>
<span class="nx">PING</span> <span class="nx">sancho</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">sancho</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">2.21</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">sancho</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.960</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">sancho</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.797</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="nx">sancho</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">5</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.797</span><span class="o">/</span><span class="mf">1.323</span><span class="o">/</span><span class="mf">2.214</span><span class="o">/</span><span class="mf">0.634</span> <span class="nx">ms</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="nx">quijote</span>
<span class="nx">PING</span> <span class="nx">quijote</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">quijote</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.493</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">quijote</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.770</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">quijote</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.685</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="nx">quijote</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">35</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.493</span><span class="o">/</span><span class="mf">0.649</span><span class="o">/</span><span class="mf">0.770</span><span class="o">/</span><span class="mf">0.117</span> <span class="nx">ms</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<p>Para Ubuntu:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span> <span class="nx">quijote</span>
<span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span> <span class="nx">dulcinea</span>
</pre></td></tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="nx">quijote</span>
<span class="nx">PING</span> <span class="nx">quijote</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">quijote</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">2.09</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">quijote</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.993</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">quijote</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.12</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">1.11</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="nx">quijote</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">3</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">3</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">2003</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.993</span><span class="o">/</span><span class="mf">1.398</span><span class="o">/</span><span class="mf">2.092</span><span class="o">/</span><span class="mf">0.493</span> <span class="nx">ms</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">ping</span> <span class="nx">dulcinea</span>
<span class="nx">PING</span> <span class="nx">dulcinea</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">dulcinea</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.880</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">dulcinea</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">1.02</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="nx">dulcinea</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">2</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">2</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">1001</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.880</span><span class="o">/</span><span class="mf">0.949</span><span class="o">/</span><span class="mf">1.018</span><span class="o">/</span><span class="mf">0.069</span> <span class="nx">ms</span>
<span class="nx">ubuntu</span><span class="p">@</span><span class="nd">sancho</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<p>Para CentOs:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span> <span class="nx">sancho</span>
<span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span> <span class="nx">dulcinea</span>
</pre></td></tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">ping</span> <span class="nx">sancho</span>
<span class="nx">PING</span> <span class="nx">sancho</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">sancho</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">2.47</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">sancho</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.11</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">1.05</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="nx">sancho</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">2</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">2</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">1001</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">1.056</span><span class="o">/</span><span class="mf">1.764</span><span class="o">/</span><span class="mf">2.473</span><span class="o">/</span><span class="mf">0.709</span> <span class="nx">ms</span>
<span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">ping</span> <span class="nx">dulcinea</span>
<span class="nx">PING</span> <span class="nx">dulcinea</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nx">bytes</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">dulcinea</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.608</span> <span class="nx">ms</span>
<span class="mi">64</span> <span class="nx">bytes</span> <span class="k">from</span> <span class="nx">dulcinea</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">.</span><span class="mf">1.4</span><span class="p">):</span> <span class="nx">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="nx">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="nx">time</span><span class="o">=</span><span class="mf">0.586</span> <span class="nx">ms</span>
<span class="o">^</span><span class="nx">C</span>
<span class="o">---</span> <span class="nx">dulcinea</span> <span class="nx">ping</span> <span class="nx">statistics</span> <span class="o">---</span>
<span class="mi">2</span> <span class="nx">packets</span> <span class="nx">transmitted</span><span class="p">,</span> <span class="mi">2</span> <span class="nx">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="nx">packet</span> <span class="nx">loss</span><span class="p">,</span> <span class="nx">time</span> <span class="mi">1000</span><span class="nx">ms</span>
<span class="nx">rtt</span> <span class="nx">min</span><span class="o">/</span><span class="nx">avg</span><span class="o">/</span><span class="nx">max</span><span class="o">/</span><span class="nx">mdev</span> <span class="o">=</span> <span class="mf">0.586</span><span class="o">/</span><span class="mf">0.597</span><span class="o">/</span><span class="mf">0.608</span><span class="o">/</span><span class="mf">0.011</span> <span class="nx">ms</span>
<span class="p">[</span><span class="nx">centos</span><span class="p">@</span><span class="nd">quijote</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> 
</pre></td></tr></tbody></table></code></pre></figure>

<h2 id="asegúrate-que-el-servidor-tiene-sincronizado-su-reloj-utilizando-un-servidor-ntp-externo">Asegúrate que el servidor tiene sincronizado su reloj utilizando un servidor NTP externo.</h2>

<p>Para configurar el servidor NTP en Linux, debemos instalar el paquete <em>ntp</em> y 
 el paquete <em>ntpdate</em>. De seguido, habilitamos el servicio:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="kd">get</span> <span class="nx">install</span> <span class="nx">ntp</span>
<span class="nx">Reading</span> <span class="kr">package</span> <span class="nx">lists</span><span class="p">...</span> <span class="nx">Done</span>
<span class="nx">Building</span> <span class="nx">dependency</span> <span class="nx">tree</span>       
<span class="nx">Reading</span> <span class="nx">state</span> <span class="nx">information</span><span class="p">...</span> <span class="nx">Done</span>
<span class="nx">ntp</span> <span class="nx">is</span> <span class="nx">already</span> <span class="nx">the</span> <span class="nx">newest</span> <span class="nx">version</span> <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mf">4.2</span><span class="p">.</span><span class="mi">8</span><span class="nx">p12</span><span class="o">+</span><span class="nx">dfsg</span><span class="o">-</span><span class="mi">4</span><span class="p">).</span>
<span class="mi">0</span> <span class="nx">upgraded</span><span class="p">,</span> <span class="mi">0</span> <span class="nx">newly</span> <span class="nx">installed</span><span class="p">,</span> <span class="mi">0</span> <span class="nx">to</span> <span class="nx">remove</span> <span class="nx">and</span> <span class="mi">3</span> <span class="nx">not</span> <span class="nx">upgraded</span><span class="p">.</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">systemctl</span> <span class="nx">enable</span> <span class="nx">ntp</span>
<span class="nx">Synchronizing</span> <span class="nx">state</span> <span class="k">of</span> <span class="nx">ntp</span><span class="p">.</span><span class="nx">service</span> <span class="kd">with</span> <span class="nx">SysV</span> <span class="nx">service</span> <span class="nx">script</span> <span class="kd">with</span> <span class="sr">/lib/</span><span class="nx">systemd</span><span class="o">/</span><span class="nx">systemd</span><span class="o">-</span><span class="nx">sysv</span><span class="o">-</span><span class="nx">install</span><span class="p">.</span>
<span class="nx">Executing</span><span class="p">:</span> <span class="o">/</span><span class="nx">lib</span><span class="o">/</span><span class="nx">systemd</span><span class="o">/</span><span class="nx">systemd</span><span class="o">-</span><span class="nx">sysv</span><span class="o">-</span><span class="nx">install</span> <span class="nx">enable</span> <span class="nx">ntp</span>
<span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="kd">get</span> <span class="nx">install</span> <span class="nx">ntpdate</span>
<span class="nx">Reading</span> <span class="kr">package</span> <span class="nx">lists</span><span class="p">...</span> <span class="nx">Done</span>
<span class="nx">Building</span> <span class="nx">dependency</span> <span class="nx">tree</span>       
<span class="nx">Reading</span> <span class="nx">state</span> <span class="nx">information</span><span class="p">...</span> <span class="nx">Done</span>
<span class="nx">The</span> <span class="nx">following</span> <span class="nx">NEW</span> <span class="nx">packages</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">installed</span><span class="p">:</span>
  <span class="nx">ntpdate</span>
<span class="mi">0</span> <span class="nx">upgraded</span><span class="p">,</span> <span class="mi">1</span> <span class="nx">newly</span> <span class="nx">installed</span><span class="p">,</span> <span class="mi">0</span> <span class="nx">to</span> <span class="nx">remove</span> <span class="nx">and</span> <span class="mi">3</span> <span class="nx">not</span> <span class="nx">upgraded</span><span class="p">.</span>
<span class="nx">Need</span> <span class="nx">to</span> <span class="kd">get</span> <span class="mi">153</span> <span class="nx">kB</span> <span class="k">of</span> <span class="nx">archives</span><span class="p">.</span>
<span class="nx">After</span> <span class="k">this</span> <span class="nx">operation</span><span class="p">,</span> <span class="mi">242</span> <span class="nx">kB</span> <span class="k">of</span> <span class="nx">additional</span> <span class="nx">disk</span> <span class="nx">space</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">used</span><span class="p">.</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">1</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//deb.debian.org/debian buster/main amd64 ntpdate amd64 1:4.2.8p12+dfsg-4 [153 kB]</span>
<span class="nx">Fetched</span> <span class="mi">153</span> <span class="nx">kB</span> <span class="k">in</span> <span class="mi">0</span><span class="nx">s</span> <span class="p">(</span><span class="mi">737</span> <span class="nx">kB</span><span class="o">/</span><span class="nx">s</span><span class="p">)</span>
<span class="nx">Selecting</span> <span class="nx">previously</span> <span class="nx">unselected</span> <span class="kr">package</span> <span class="nx">ntpdate</span><span class="p">.</span>
<span class="p">(</span><span class="nx">Reading</span> <span class="nx">database</span> <span class="p">...</span> <span class="mi">27036</span> <span class="nx">files</span> <span class="nx">and</span> <span class="nx">directories</span> <span class="nx">currently</span> <span class="nx">installed</span><span class="p">.)</span>
<span class="nx">Preparing</span> <span class="nx">to</span> <span class="nx">unpack</span> <span class="p">...</span><span class="o">/</span><span class="nx">ntpdate_1</span><span class="o">%</span><span class="mi">3</span><span class="nx">a4</span><span class="p">.</span><span class="mf">2.8</span><span class="nx">p12</span><span class="o">+</span><span class="nx">dfsg</span><span class="o">-</span><span class="mi">4</span><span class="nx">_amd64</span><span class="p">.</span><span class="nx">deb</span> <span class="p">...</span>
<span class="nx">Unpacking</span> <span class="nx">ntpdate</span> <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mf">4.2</span><span class="p">.</span><span class="mi">8</span><span class="nx">p12</span><span class="o">+</span><span class="nx">dfsg</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="p">...</span>
<span class="nx">Setting</span> <span class="nx">up</span> <span class="nx">ntpdate</span> <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mf">4.2</span><span class="p">.</span><span class="mi">8</span><span class="nx">p12</span><span class="o">+</span><span class="nx">dfsg</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="p">...</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Una vez descargado y habilitado, editaremos el fichero <em>/etc/ntp.conf</em>
y añadiremos las siguientes lineas:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="code"><pre><span class="nx">server</span> <span class="mi">0</span><span class="p">.</span><span class="nx">es</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">ntp</span><span class="p">.</span><span class="nx">org</span>
<span class="nx">server</span> <span class="mi">0</span><span class="p">.</span><span class="nx">europe</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">ntp</span><span class="p">.</span><span class="nx">org</span>
<span class="nx">server</span> <span class="mi">2</span><span class="p">.</span><span class="nx">europe</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">ntp</span><span class="p">.</span><span class="nx">org</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Acto seguido, reiniciaremos el servicio NTP y ejecutamos el comando:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">ntpdate</span> <span class="o">-</span><span class="nx">u</span> <span class="nx">pool</span><span class="p">.</span><span class="nx">ntp</span><span class="p">.</span><span class="nx">org</span>
<span class="mi">14</span> <span class="nx">Nov</span> <span class="mi">20</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">42</span> <span class="nx">ntpdate</span><span class="p">[</span><span class="mi">1675</span><span class="p">]:</span> <span class="nx">adjust</span> <span class="nx">time</span> <span class="nx">server</span> <span class="mf">213.251</span><span class="p">.</span><span class="mf">52.234</span> <span class="nx">offset</span> <span class="o">-</span><span class="mf">0.002713</span> <span class="nx">sec</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Y comprobamos que funciona:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="nx">debian</span><span class="p">@</span><span class="nd">dulcinea</span><span class="p">:</span><span class="o">~</span><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">date</span>
<span class="nx">Sat</span> <span class="mi">14</span> <span class="nx">Nov</span> <span class="mi">2020</span> <span class="mi">08</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">48</span> <span class="nx">PM</span> <span class="nx">UTC</span>
</pre></td></tr></tbody></table></code></pre></figure>



  
    
      <div class="post-tags-section">
  <i class="post-tags-icon fas fa-tags"></i>
  <ul class="post-tags"><li>
        <a class="post-tag" href="/tags/#debian">debian</a></li><li>
        <a class="post-tag" href="/tags/#ubuntu">ubuntu</a></li><li>
        <a class="post-tag" href="/tags/#centos">centos</a></li><li>
        <a class="post-tag" href="/tags/#nat">nat</a></li><li>
        <a class="post-tag" href="/tags/#tutorial">tutorial</a></li><li>
        <a class="post-tag" href="/tags/#comandos">comandos</a></li></ul>
</div>

  

  
</article>


<aside class="related">
  <h2>Related posts</h2>
  <ul class="related-posts">
    
      <li>
        <a href="/2021/03/16/configuracion-servicios/">
          Servidores Web, Base de datos y DNS
          <small><time datetime="2021-03-16T09:16:00+01:00">16 Mar 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2021/03/15/rocketchat-docker/">
          Rocket.Chat implementado con Docker
          <small><time datetime="2021-03-15T06:31:00+01:00">15 Mar 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2021/03/11/introducci%C3%B3n-a-docusaurus/">
          Introducción a Docusaurus y Surge
          <small><time datetime="2021-03-11T15:31:00+01:00">11 Mar 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


</main>

<footer class="footer"><small>
    &copy; 2020&nbsp;-&nbsp;2021 <a href="https://github.com/ManuelLoraRoman">Manuel Lora Román</a>. All rights reserved.
    Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://github.com/vszhub/not-pure-poole">Not Pure Poole</a>.
  </small>
</footer>
</div>
      <div class="sidebar-right pure-u-1 pure-u-md-1-4">
<div  class="toc-wrapper">
  <h2 class="toc-title">Table of Contents</h2>
    <nav class="toc-nav">
      <ul class="toc">
  <li><a href="#creación-de-la-red-interna">Creación de la red interna:</a></li>
  <li><a href="#creación-de-las-instancias">Creación de las instancias</a></li>
  <li><a href="#configuración-de-nat-en-dulcinea">Configuración de NAT en Dulcinea</a></li>
  <li><a href="#definición-de-contraseña-en-todas-las-instancias">Definición de contraseña en todas las instancias</a></li>
  <li><a href="#modificación-de-las-instancias-sancho-y-quijote-para-que-usen-direccionamiento-estático-y-dulcinea-como-puerta-de-enlace">Modificación de las instancias sancho y quijote para que usen direccionamiento estático y dulcinea como puerta de enlace</a></li>
  <li><a href="#modificación-de-la-subred-de-la-red-interna-deshabilitando-el-servidor-dhcp">Modificación de la subred de la red interna, deshabilitando el servidor DHCP</a></li>
  <li><a href="#utilización-de-ssh-agent-para-acceder-a-las-instancias">Utilización de ssh-agent para acceder a las instancias</a></li>
  <li><a href="#creación-del-usuario-profesor-en-todas-las-instancias-usuario-que-puede-utilizar-sudo-sin-contraseña">Creación del usuario profesor en todas las instancias. Usuario que puede utilizar sudo sin contraseña</a></li>
  <li><a href="#copia-de-las-claves-públicas-de-todos-los-profesores-en-las-instancias-para-que-puedan-acceder-con-el-usuario-profesor">Copia de las claves públicas de todos los profesores en las instancias para que puedan acceder con el usuario profesor</a></li>
  <li><a href="#realiza-una-actualización-completa-de-todos-los-servidores">Realiza una actualización completa de todos los servidores</a></li>
  <li><a href="#configura-el-servidor-con-el-nombre-de-dominio-gonzalonazarenoorg">Configura el servidor con el nombre de dominio <nombre-usuario>.gonzalonazareno.org</nombre-usuario></a></li>
  <li><a href="#hasta-que-no-esté-configurado-el-servidor-dns-incluye-resolución-estática-en-las-tres-instancias">Hasta que no esté configurado el servidor DNS, incluye resolución estática en las tres instancias</a></li>
  <li><a href="#asegúrate-que-el-servidor-tiene-sincronizado-su-reloj-utilizando-un-servidor-ntp-externo">Asegúrate que el servidor tiene sincronizado su reloj utilizando un servidor NTP externo.</a></li>
</ul>

  </nav>
</div>

</div>
    </div>

    <script async src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script><script>
  function strip(str, remove) {
    while (str.length > 0 && remove.indexOf(str.charAt(0)) != -1) {
      str = str.substr(1);
    }
    while (str.length > 0 && remove.indexOf(str.charAt(str.length - 1)) != -1) {
      str = str.substr(0, str.length - 1);
    }
    return str;
  }

  function scroll() {
    console.log('scroll');
    window.scrollTo({
      left: 0, 
      top: window.innerHeight,
      behavior: 'smooth'
    });
    sessionStorage.removeItem('forceCheckScroll');
  }

  const forceCheckScroll = sessionStorage.getItem('forceCheckScroll') === 'true';
  const checkScroll = strip(window.location.pathname, '/') !== strip('', '/');

  if (forceCheckScroll || checkScroll) {
    const maxWidth = "(max-width: 48rem)";
    const result = window.matchMedia(maxWidth);
    if (result.matches) {
      scroll();
    } else {
      result.addListener((match) => {
        if (match.media == maxWidth) {
          if (match.matches) {
            scroll();
          }
        }
      });
    }
  }
</script>
</body>
</html>
